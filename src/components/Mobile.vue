<template>
  <div>
    <div id="playlistlist" class="container pl">

      <div id="5otni8xbcdesXyqYjGNdH3" v-on:click="fetchInit" class="hr-line-dashed">Chill</div>

      <div id="4K2RlkLBLijwRBgCEM69yN" v-on:click="fetchInit" class="hr-line-dashed">Wave</div>

      <div id="4eKgt1g7GsTE4tpZIbKGER" v-on:click="fetchInit" class="hr-line-dashed">Dance rising: selected</div>

      <div id="6sKGdJlWmzgsus5VBCrc8p" v-on:click="fetchInit" class="hr-line-dashed">Selected</div>

      <div id="28ZxMxSvYtOVsJeRXGxrMf" v-on:click="fetchInit" class="hr-line-dashed">Fresh Finds:Basement (Selected)</div>

      <div id="75FcI0WTzcS5uVRVqYb2w7" v-on:click="fetchInit" class="hr-line-dashed">Release Radar 2021-04-20 </div>

      <div id="3INVfBrRB3KoJ1LcPBRThx" v-on:click="fetchInit" class="hr-line-dashed">Открытия:резерв</div>

      <div id="4FQmKFEUWf3zys8v3ijCqt" v-on:click="fetchInit" class="hr-line-dashed">Развал снисхождения</div>

      <div id="6A7Rws0vkbbEBcJZnBvmr6" v-on:click="fetchInit" class="hr-line-dashed">Radar</div>

      <div id="6NT3wDHN4Pf8XT7pv2gvh9" v-on:click="fetchInit" class="hr-line-dashed">Record</div>

      <div id="6edGcdcn3rvVDjgtky8Sid" v-on:click="fetchInit" class="hr-line-dashed">The same sample</div>

      <div id="1NPsHBF0TxgrbwtRX7jQDL" v-on:click="fetchInit" class="hr-line-dashed">Радар 2 2021-02-07 </div>

      <div id="4XcOH667raSbKNdEyo0sXh" v-on:click="fetchInit" class="hr-line-dashed">Fresh Finds: Best of Basement 2020</div>

      <div id="2zluqMk5zn75zTTiyyIukH" v-on:click="fetchInit" class="hr-line-dashed">Радар:резерв</div>

      <div id="37i9dQZF1DX6bBjHfdRnza" v-on:click="fetchInit" class="hr-line-dashed">Fresh Finds: Basement</div>

      <div id="37i9dQZF1EMaHzgJK8QEZ7" v-on:click="fetchInit" class="hr-line-dashed">Your Top Songs 2020</div>

      <div id="37i9dQZEVXcERLiUqU2pJX" v-on:click="fetchInit" class="hr-line-dashed">Discover Weekly</div>

      <div id="37i9dQZEVXbsudmxBFKW7G" v-on:click="fetchInit" class="hr-line-dashed">Release Radar</div>

      <div id="2c5xActenxAQrVi6YARtb6" v-on:click="fetchInit" class="hr-line-dashed">Groove Theory:Selected</div>

      <div id="1Dp3YCiT3K47Rp4vnSyYFk" v-on:click="fetchInit" class="hr-line-dashed">Vibra Tropical:Selected</div>

      <div id="5LtCw9kUKtdg0A9XMztW3T" v-on:click="fetchInit" class="hr-line-dashed">Disco</div>

      <div id="37i9dQZF1DWYzxqzx1puO0" v-on:click="fetchInit" class="hr-line-dashed">Calvin Harris Guest List</div>

      <div id="2UzjvZJ5VHyYkw2BHa0BXn" v-on:click="fetchInit" class="hr-line-dashed">Neurofunk</div>

      <div id="1UAOiLXScUaID0szlMjIi0" v-on:click="fetchInit" class="hr-line-dashed">Liquid Funk</div>

      <div id="6pl3mlKgqMBKiXd87Q37ld" v-on:click="fetchInit" class="hr-line-dashed">Chill House</div>

      <div id="0FCHh4sY8PPYNO0bb6fWVE" v-on:click="fetchInit" class="hr-line-dashed">Tecktonik</div>

      <div id="3VdWJVw4Y7eKG6ClBgzp40" v-on:click="fetchInit" class="hr-line-dashed">playlist50246148</div>

      <div id="5A8OqmSndfCrgrjac1QU28" v-on:click="fetchInit" class="hr-line-dashed">90s</div>

      <div id="37i9dQZF1DX3fXJqxGjuEP" v-on:click="fetchInit" class="hr-line-dashed">Vibra Tropical</div>

      <div id="6Aeepso6EVNBtOMYlxiN0F" v-on:click="fetchInit" class="hr-line-dashed">In search of perfection</div>

      <div id="56eX19CJMKkOdRoP7MUbfP" v-on:click="fetchInit" class="hr-line-dashed">Alt/Indie</div>

      <div id="3UUrYHXVi7wEvV22PYVUBP" v-on:click="fetchInit" class="hr-line-dashed">Макс Корж</div>

      <div id="6uznlwNfHdzomWhDH7u0t7" v-on:click="fetchInit" class="hr-line-dashed">Big Room</div>

      <div id="40meYd6RrWYIbkA4m0tGBQ" v-on:click="fetchInit" class="hr-line-dashed">Deep</div>

      <div id="237ZMZLnF04RJYLZ7VKNVe" v-on:click="fetchInit" class="hr-line-dashed">Dramina</div>

      <div id="46GbJCgS1j3YiWTfTs7kCy" v-on:click="fetchInit" class="hr-line-dashed"></div>

      <div id="21cjdovZeJLdUoaOsp8fPI" v-on:click="fetchInit" class="hr-line-dashed">Пюрешка с котлеткой</div>

      <div id="22blj6QK5pSrP5qCY9Qad3" v-on:click="fetchInit" class="hr-line-dashed">2016-2017</div>

      <div id="4MfLQqGloiHb6Acqxfiryx" v-on:click="fetchInit" class="hr-line-dashed">Gold days</div>

      <div id="37i9dQZF1DX1wOOgfKQTlO" v-on:click="fetchInit" class="hr-line-dashed">Побег к океану</div>

      <div id="37i9dQZF1DXdQP3bGyOAvs" v-on:click="fetchInit" class="hr-line-dashed">100% Lounge</div>

      <div id="37i9dQZF1DX8a1tdzq5tbM" v-on:click="fetchInit" class="hr-line-dashed">Dance Classics</div>

      <div id="37i9dQZF1EJMMkftayk8vd" v-on:click="fetchInit" class="hr-line-dashed">Whywisked + BeatVito</div>


    </div>
    <!--    <div id="playlist" class="container-fluid con2">-->
    <!--      <div id="p_" class="con2">-->
    <!--        <div class="con4">{{ playinfo.name }}</div>-->
    <!--        <div style="width: 60%; display: flex; align-items: center;">-->
    <!--          <div>-->
    <!--            <a v-bind:href="playinfo.name" target="_blank">-->
    <!--              <button class="button">Open is Spotify</button>-->
    <!--            </a>-->
    <!--          </div>-->
    <!--          <div class="con4" v-bind:style="{ 'background-image': 'url(' + playinfo['images'][0]['url'] + ')' }" style=" background-repeat: no-repeat; background-size: cover;"></div>-->
    <!--        </div>-->
    <!--        </div>-->
    <!--      </div>-->
    <div class="container-fluid con2" style="display: flex;color: black">
      <div class="trackbody" v-for="item of playlists" v-bind:key="item.id">
        <div v-if="item.track.preview_url" tabindex="0" class="con3" v-on:click="click" v-bind:style="{ 'background-image': 'url(' + item.track.album.images[0].url + ')' }" >{{lists(item['track']['artists'])}}
          <audio preload="none" v-bind:src="item.track.preview_url"></audio>
        </div>
        <div v-else tabindex="0" class="con3" v-bind:style="{ 'background-image': 'url(' + item.track.album.images[0].url + ')' }" style="opacity: .5">
          <audio preload="none"></audio>
        </div>
      </div>


    </div>
    <div v-on:click="fetchArtist">Top artists
      <div id="topartist" class="container-fluid con2" style="display: flex;color: black">
        <div class="trackbody" v-for="item of topartist" v-bind:key="item.id">
          <div v-if="item.preview_url" tabindex="0" class="con3" v-on:click="click" v-bind:style="{ 'background-image': 'url(' + item.images[1].url + ')' }" >{{item.name}}
            <audio preload="none" v-bind:src="item.preview_url"></audio>
          </div>
          <div v-else tabindex="0" class="con3" v-bind:style="{ 'background-image': 'url(' + item.images[1].url + ')' }" style="opacity: .5">{{item.name}}
            <audio preload="none"></audio>
          </div>
        </div>
      </div>
    </div>
    <br>
    <div v-on:click="fetchArtist2">Top artists 6 month
      <div id="topartist6" class="container-fluid con2" style="display: flex;color: black">
        <div class="trackbody" v-for="item of topartist6" v-bind:key="item.id">
          <div v-if="item.preview_url" tabindex="0" class="con3"  v-on:click="click" v-bind:style="{ 'background-image': 'url(' + item.images[1].url + ')' }">{{item.name}}
            <audio preload="none" v-bind:src="item.preview_url"></audio>
          </div>
          <div v-else tabindex="0" class="con3" v-bind:style="{ 'background-image': 'url(' + item.images[1].url + ')' }" style="opacity: .5">{{item.name}}
            <audio preload="none"></audio>
          </div>
        </div>
      </div>
    </div>
    <br>
    <div v-on:click="fetchArtist3">Top artists all time
      <div id="topartista" class="container-fluid con2" style="display: flex;color: black">
        <div class="trackbody" v-for="item of topartista" v-bind:key="item.id">
          <div v-if="item.preview_url" tabindex="0" class="con3"  v-on:click="click" v-bind:style="{ 'background-image': 'url(' + item.images[1].url + ')' }">{{item.name}}
            <audio preload="none" v-bind:src="item.preview_url"></audio>
          </div>
          <div v-else tabindex="0" class="con3"  v-bind:style="{ 'background-image': 'url(' + item.images[1].url + ')' }" style="opacity: .5">{{item.name}}
            <audio preload="none"></audio>
          </div>
        </div>
      </div>
    </div>
    <br>
    <div v-on:click="fetchApi">Top tracks
      <div id="toptrack" class="container-fluid con2" style="display: flex;color: black">
        <div class="trackbody" v-for="item of items" v-bind:key="item.id">
          <div v-if="item.preview_url" tabindex="0" class="con3" v-on:click="click" v-bind:style="{ 'background-image': 'url(' + item.album.images[0].url + ')' }">{{lists(item.artists)}}
            <audio preload="none" v-bind:src="item.preview_url"></audio>
          </div>
          <div v-else tabindex="0" class="con3" v-bind:style="{ 'background-image': 'url(' + item.album.images[0].url + ')' }" style="opacity: .5">{{lists(item.artists)}}
            <audio preload="none"></audio>
          </div>
        </div>
      </div>
    </div>
    <br>
    <div v-on:click="fetchApi2">Top tracks 6
      <div id="toptrack6" class="container-fluid con2" style="display: flex;color: black" >
        <div class="trackbody" v-for="item of itemsm" v-bind:key="item.id">
          <div v-if="item.preview_url" tabindex="0" class="con3" v-on:click="click" v-bind:style="{ 'background-image': 'url(' + item.album.images[0].url + ')' }" >{{lists(item.artists)}}
            <audio preload="none" v-bind:src="item.preview_url"></audio>
          </div>
          <div v-else tabindex="0" class="con3" v-bind:style="{ 'background-image': 'url(' + item.album.images[0].url + ')' }" style="opacity: .5">{{lists(item.artists)}}
            <audio preload="none"></audio>
          </div>
        </div>
      </div>
    </div>
    <br>
    <div v-on:click="fetchApi3">Top tracks all time
      <div id="toptrackall" class="container-fluid con2" style="display: flex;color: black" >
        <div class="trackbody" v-for="item of itemsl" v-bind:key="item.id">
          <div v-if="item.preview_url" tabindex="0" class="con3" v-on:click="click" v-bind:style="{ 'background-image': 'url(' + item.album.images[0].url + ')' }" >{{lists(item.artists)}}
            <audio preload="none" v-bind:src="item.preview_url"></audio>
          </div>
          <div v-else tabindex="0" class="con3" v-bind:style="{ 'background-image': 'url(' + item.album.images[0].url + ')' }" style="opacity: .5">{{lists(item.artists)}}
            <audio preload="none"></audio>
          </div>
        </div>
      </div>
    </div>
    <br>
    <div v-on:click="fetchAlbums">Saved albums
      <div id="savedalbum" class="container-fluid con2">
        <div class="albumbody" v-for="item of savedalbums" v-bind:key="item.id">
          <div v-if="item.preview_url" tabindex="0" class="con3" v-on:click="click" v-bind:style="{ 'background-image': 'url(' + item.album.images[0].url + ')' }" >{{lists(item.album.artists)}}
            <audio preload="none" v-bind:src="item.preview_url"></audio>
          </div>
          <div v-else tabindex="0" class="con3" v-bind:style="{ 'background-image': 'url(' + item.album.images[0].url + ')' }" style="opacity: .5">{{lists(item.album.artists)}}
            <audio preload="none"></audio>
          </div>
        </div>
      </div>
    </div>
    <div v-on:click="fetchTracks">Saved tracks
      <div id="savedtrack" class="container-fluid con2">
        <div class="albumbody" v-for="item of savedtracks" v-bind:key="item.id">
          <div v-if="item.track.preview_url" tabindex="0" class="con3" v-on:click="click" v-bind:style="{ 'background-image': 'url(' + item.track.album.images[0].url + ')' }" >{{lists(item.track.artists)}}
            <audio preload="none" v-bind:src="item.track.preview_url"></audio>
          </div>
          <div v-else tabindex="0" class="con3" v-bind:style="{ 'background-image': 'url(' + item.track.album.images[0].url + ')' }" style="opacity: .5">{{lists(item.track.artists)}}
            <audio preload="none"></audio>
          </div>
        </div>
      </div>
    </div>
    <br>
    <div v-on:click="fetchFA">Followed artist
      <div id="followedartist" class="container-fluid con2">
        <div class="fabody" v-for="item of followedartists" v-bind:key="item.id">
          <div v-if="item.preview_url" tabindex="0" class="con3" v-on:click="click" v-bind:style="{ 'background-image': 'url(' + item.images[0].url + ')' }" >{{item.name}}
            <audio preload="none" v-bind:src="item.preview_url"></audio>
          </div>
          <div v-else tabindex="0" class="con3" v-bind:style="{ 'background-image': 'url(' + item.images[0].url + ')' }" style="opacity: .5">{{item.name}}
            <audio preload="none"></audio>
          </div>
        </div>
      </div>
    </div>
    <br>
    <div v-on:click="fetchNR">New releases
      <div id="newrelease" class="container-fluid con2">
        <div class="newbody" v-for="item of newreleases" v-bind:key="item.id">
          <div v-if="item.tracks.items[0].preview_url" tabindex="0" class="con3" v-on:click="click" v-bind:style="{ 'background-image': 'url(' + item.images[0].url + ')' }" >{{lists(item.artists)}}
            <audio preload="none" v-bind:src="item.tracks.items[0].preview_url"></audio>
          </div>
          <div v-else tabindex="0" class="con3" v-bind:style="{ 'background-image': 'url(' + item.images[0].url + ')' }" style="opacity: .5">{{lists(item.artists)}}
            <audio preload="none"></audio>
          </div>
        </div>
      </div>
    </div>
  </div>
</template>

<script>
import axios from 'axios'
export default {
  data(){
    return{
      playinfo:[],
      playlists:[],
      topartist:[],
      topartist6:[],
      topartista:[],
      savedalbums:[],
      savedtracks:[],
      newreleases:[],
      followedartists:[],
      items:[],
      itemsm:[],
      itemsl:[]
    }
  },
  methods: {
    fetchInit:function(event){
      console.log('167'  + event.currentTarget.id)
      let id = event.currentTarget.id
      axios.request({
        url:'https://api.spotify.com/v1/playlists/' + id,
        method: 'get',
        headers: {'Authorization': 'Bearer '}
      })
          .then((response) =>{
            this.playinfo = response.data
            this.playlists = response.data['tracks']['items']
          })
          .catch()
    },
    fetchArtist(){
      axios.request({
        url:'https://api.spotify.com/v1/me/top/artists?time_range=short_term',
        method: 'get',
        headers: {'Authorization': 'Bearer '}
      })
          .then((response) =>{
            let newarr = []
            let items =response.data['items']
            console.log('235' + items[0].id)
            for (let i=0;i <  items.length;i++){
              console.log('237' + items[i].id)
              axios.request({
                url:'https://api.spotify.com/v1/artists/' + items[i].id + '/top-tracks?market=UA',
                method: 'get',
                headers: {'Authorization': 'Bearer '}
              })
                  .then((response) =>{
                    console.log('247' + response.data)
                    let tracks = response.data['tracks']
                    if (tracks[0]['preview_url']){
                      items[i].preview_url = tracks[0]['preview_url']
                    }
                    newarr.push(items[i])

                  })
            }
            this.topartist = newarr
          })
          .catch()
    },
    fetchArtist2(){
      axios.request({
        url:'https://api.spotify.com/v1/me/top/artists?time_range=medium_term',
        method: 'get',
        headers: {'Authorization': 'Bearer '}
      })
          .then((response) =>{
            let newarr = []
            let items =response.data['items']
            console.log('235' + items[0].id)
            for (let i=0;i <  items.length;i++){
              console.log('237' + items[i].id)
              axios.request({
                url:'https://api.spotify.com/v1/artists/' + items[i].id + '/top-tracks?market=UA',
                method: 'get',
                headers: {'Authorization': 'Bearer '}
              })
                  .then((response) =>{
                    console.log('247' + response.data)
                    let tracks = response.data['tracks']
                    if (tracks[0]['preview_url']){
                      items[i].preview_url = tracks[0]['preview_url']
                    }
                    newarr.push(items[i])

                  })
            }
            this.topartist6 = newarr
          })
          .catch()
    },
    fetchArtist3(){
      axios.request({
        url:'https://api.spotify.com/v1/me/top/artists?time_range=long_term',
        method: 'get',
        headers: {'Authorization': 'Bearer BQCyUlkW-Pdh6ZOxP5dxvphBkRWlqbt28GUGwO36KdV70O64STUty3J_ITjR7p2BVALLiglBvDUKE499eA6hZsSBVtCgxzYoq_JAu5rF4zEMLtTY43buWy-gCzpkEliB1Nlqu4xb4jRKnJFHGg_ei92-NaWef4A5whd6tjxoNJUS2G8Zqgeu71MOtE6SGPJNZCnECW6XitrC4jADND1DBpG7xOz6_VpZOkKPjTGWD1D2-3Ip6A'}
      })
          .then((response) =>{
            let newarr = []
            let items =response.data['items']
            console.log('235' + items[0].id)
            for (let i=0;i <  items.length;i++){
              console.log('237' + items[i].id)
              axios.request({
                url:'https://api.spotify.com/v1/artists/' + items[i].id + '/top-tracks?market=UA',
                method: 'get',
                headers: {'Authorization': 'Bearer '}
              })
                  .then((response) =>{
                    console.log('247' + response.data)
                    let tracks = response.data['tracks']
                    if (tracks[0]['preview_url']){
                      items[i].preview_url = tracks[0]['preview_url']
                    }
                    newarr.push(items[i])

                  })
            }
            this.topartista = newarr
          })
          .catch()
    },
    fetchApi(){
      axios.request({
        url:'https://api.spotify.com/v1/me/top/tracks?time_range=short_term',
        method: 'get',
        headers: {'Authorization': 'Bearer '}
      })
          .then((response) =>{
            this.items = response.data['items']
          })
          .catch()
    },
    fetchApi2(){
      axios.request({
        url:'https://api.spotify.com/v1/me/top/tracks?time_range=medium_term',
        method: 'get',
        headers: {'Authorization': 'Bearer '}
      })
          .then((response) =>{
            this.itemsm = response.data['items']
          })
          .catch()
    },
    fetchApi3(){
      axios.request({
        url:'https://api.spotify.com/v1/me/top/tracks?time_range=long_term',
        method: 'get',
        headers: {'Authorization': 'Bearer '}
      })
          .then((response) =>{
            this.itemsl = response.data['items']
          })
          .catch()
    },
    fetchAlbums(){
      axios.request({
        url: 'https://api.spotify.com/v1/me/albums',
        method: 'get',
        headers: {'Authorization': 'Bearer '}
      })
          .then((response) =>{
            let newarr = []
            let items =response.data['items']
            console.log('235' + items[0].id)
            for (let i=0;i <  items.length;i++){
              console.log('237' + items[i].id)
              axios.request({
                url:'https://api.spotify.com/v1/albums/' + items[i].album.id + '/tracks?market=UA&limit=10',
                method: 'get',
                headers: {'Authorization': 'Bearer '}
              })
                  .then((response) =>{
                    console.log('247' + response.data)
                    let tracks = response.data['items']
                    if (tracks[0]['preview_url']){
                      items[i].preview_url = tracks[0]['preview_url']
                    }
                    newarr.push(items[i])

                  })
            }
            this.savedalbums = newarr
          })
          .catch()
    },
    fetchTracks(){
      axios.request({
        url: 'https://api.spotify.com/v1/me/tracks?offset=' + 0 + '&limit=50',
        method: 'get',
        headers: {'Authorization': 'Bearer '}
      })
          .then((response) =>{
            this.savedtracks =response.data['items']

          })
          .catch((onerror) =>{
            console.log(onerror)
          })
    },
    fetchNR(){
      axios.request({
        url: 'https://api.spotify.com/v1/browse/new-releases?limit=20&offset=' + 0,
        method: 'get',
        headers: {'Authorization': 'Bearer '}
      })
          .then((response) =>{
            let newarr = []
            let items =response.data['albums']['items']
            console.log('235' + items[0].id)
            for (let i=0;i <  items.length;i++){
              newarr.push(items[i].id)
            }
            axios.request({
              url:'https://api.spotify.com/v1/albums?ids=' + newarr ,
              method: 'get',
              headers: {'Authorization': 'Bearer '}
            })
                .then((response) => {
                  this.newreleases = response.data['albums']}

                )


          })
          .catch()
    },
    fetchFA(){
      axios.request({
        url: 'https://api.spotify.com/v1/me/following?type=artist&limit=50',
        method: 'get',
        headers: {'Authorization': 'Bearer '}
      })
          .then((response) =>{
            let newarr = []
            let items =response.data['artists']['items']
            for (let i=0;i <  items.length;i++){
              console.log('237 ' + items[i].id)
              axios.request({
                url:'https://api.spotify.com/v1/artists/' + items[i].id + '/top-tracks?market=UA&limit=10',
                method: 'get',
                headers: {'Authorization': 'Bearer '}
              })
                  .then((response) =>{
                    let tracks = response.data['tracks']
                    if (tracks[0]['preview_url']){
                      items[i].preview_url = tracks[0]['preview_url']
                    }
                    newarr.push(items[i])

                  })
            }
            this.followedartists = newarr
          })
          .catch()
    },
    click: function (event){
      let target = event.target
      let audios = target.lastChild
      if (audios.paused == false) {
        audios.pause()
      } else
      audios.play()
    },
    lists: function (artists){
      const names = artists.map(({
                                   name
                                 }) => name);
      const finalName = names.pop();
      return names.length ?
          names.join(', ') + ' & ' + finalName :
          finalName;
    },
  }

}


</script>

<!-- Add "scoped" attribute to limit CSS to this component only -->
<style scoped>
h3 {
  margin: 40px 0 0;
}
ul {
  list-style-type: none;
  padding: 0;
}
li {
  display: inline-block;
  margin: 0 10px;
}
a {
  color: #42b983;
}
</style>
